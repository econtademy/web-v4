<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eContademy | Cursos Online Certificados y Consultor√≠a</title>
    
    <meta name="description" content="Aprende programaci√≥n, contabilidad y negocios con eContademy. Cursos pr√°cticos, certificados y mentor√≠a experta para impulsar tu carrera profesional.">
    <meta name="keywords" content="cursos online, python, contabilidad, excel, desarrollo web, certificaciones, e-learning">
    <meta name="author" content="eContademy Team">

    <meta property="og:type" content="website">
    <meta property="og:title" content="eContademy | Transforma tu Futuro Profesional">
    <meta property="og:description" content="Aprende habilidades reales con proyectos pr√°cticos.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1200">

    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                fontFamily: { sans: ['Outfit', 'sans-serif'] },
                extend: {
                    colors: {
                        brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 900: '#1e3a8a' },
                        dark: '#0f172a',
                        accent: '#f59e0b'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'slide-up': 'slideUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'scale-up': 'scaleUp 0.3s ease-out forwards'
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { opacity: '0', transform: 'translateY(40px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        scaleUp: { '0%': { transform: 'scale(0.9)', opacity: '0' }, '100%': { transform: 'scale(1)', opacity: '1' } }
                    }
                }
            }
        }
    </script>

    <style>
        /* UTILITIES & GLASSMORPHISM */
        .glass-nav { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.5); }
        
        /* SLIDER AVANZADO */
        .slider-container { position: relative; height: 85vh; min-height: 650px; overflow: hidden; background: #000; }
        .slide { position: absolute; inset: 0; opacity: 0; transition: opacity 1.2s ease-in-out, transform 8s ease; transform: scale(1.05); }
        .slide.active { opacity: 1; z-index: 10; transform: scale(1); }
        .slide-overlay { background: linear-gradient(to top, #0f172a 0%, rgba(15, 23, 42, 0.4) 100%); position: absolute; inset: 0; z-index: 2; }
        .slide-text { position: relative; z-index: 20; }

        /* Loader & Skeleton */
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid #3b82f6; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .skeleton { background: linear-gradient(90deg, #e2e8f0 25%, #cbd5e1 50%, #e2e8f0 75%); background-size: 200% 100%; animation: loading 1.5s infinite; }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        
        /* SKELETON */
        .skeleton { background: linear-gradient(90deg, #e2e8f0 25%, #cbd5e1 50%, #e2e8f0 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

        /* Video Container */
        .iframe-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; background: #000; }
        .iframe-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

    </style>
</head>
<body class="bg-slate-50 text-slate-800 flex flex-col min-h-screen antialiased selection:bg-brand-500 selection:text-white">

    <header class="fixed w-full z-50 transition-all duration-300 glass-nav" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <a href="#" onclick="app.router('home')" class="flex items-center gap-2 group cursor-pointer">
                    <div class="bg-brand-600 text-white p-2 rounded-xl shadow-lg shadow-brand-500/30 group-hover:scale-105 transition duration-300">
                        <i data-lucide="zap" class="w-6 h-6"></i>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-2xl font-bold tracking-tight text-slate-900 leading-none">eConta<span class="text-brand-600">demy</span></span>
                        <span class="text-[10px] font-bold tracking-widest uppercase text-slate-400">Education</span>
                    </div>
                </a>

                <nav class="hidden lg:flex items-center gap-8 font-semibold text-slate-600 text-sm uppercase tracking-wide">
                    <a href="#" onclick="app.router('home')" class="hover:text-brand-600 transition border-b-2 border-transparent hover:border-brand-600 py-1">Inicio</a>
                    <a href="#" onclick="app.router('store')" class="hover:text-brand-600 transition border-b-2 border-transparent hover:border-brand-600 py-1">Cursos</a>
                    <a href="#" onclick="app.router('services')" class="hover:text-brand-600 transition border-b-2 border-transparent hover:border-brand-600 py-1">Servicios</a>
                    <a href="#" onclick="app.router('blog')" class="hover:text-brand-600 transition border-b-2 border-transparent hover:border-brand-600 py-1">Blog</a>
                    <a href="#" onclick="app.router('contact')" class="hover:text-brand-600 transition py-1 nav-link">Contacto</a>
                </nav>

                <div class="flex items-center gap-4">
                    <button onclick="app.toggleCart()" class="relative p-2 hover:bg-slate-100 rounded-full transition group">
                        <i data-lucide="shopping-cart" class="w-6 h-6 text-slate-700 group-hover:text-brand-600"></i>
                        <span id="cart-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold h-5 w-5 flex items-center justify-center rounded-full shadow-sm transform scale-0 transition-transform">0</span>
                    </button>
                    
                    <button onclick="app.router('lms')" class="hidden md:flex bg-slate-900 text-white px-6 py-2.5 rounded-full font-bold text-sm hover:bg-slate-800 transition shadow-xl shadow-slate-900/20 items-center gap-2">
                        <i data-lucide="user" class="w-4 h-4"></i> Aula Virtual
                    </button>
                    
                    <button class="lg:hidden text-slate-700" onclick="toggleMobile()"><i data-lucide="menu" class="w-8 h-8"></i></button>
                </div>
            </div>
        </div>
        
        <div id="mobile-menu" class="hidden lg:hidden bg-white border-t absolute w-full shadow-xl z-50">
            <div class="flex flex-col p-6 space-y-4 font-bold text-center text-lg">
                <a href="#" onclick="app.router('home');toggleMobile()">Inicio</a>
                <a href="#" onclick="app.router('store');toggleMobile()">Cursos</a>
                <a href="#" onclick="app.router('lms');toggleMobile()" class="text-brand-600">Aula Virtual</a>
            </div>
        </div>
    </header>

    <main id="main-view" class="flex-grow pt-20 min-h-screen">
        <div class="max-w-7xl mx-auto px-4 py-20 space-y-8 animate-pulse">
            <div class="h-96 bg-slate-200 rounded-3xl w-full"></div>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="h-64 bg-slate-200 rounded-2xl"></div>
                <div class="h-64 bg-slate-200 rounded-2xl"></div>
                <div class="h-64 bg-slate-200 rounded-2xl"></div>
            </div>
        </div>
    </main>

    <footer class="bg-dark text-slate-400 pt-20 pb-10 border-t border-slate-800 mt-auto">
        <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-4 gap-12 mb-12">
            <div class="col-span-1 md:col-span-2">
                <h3 class="text-white text-2xl font-bold mb-4 flex items-center gap-2"><i data-lucide="zap" class="text-brand-500"></i> eContademy</h3>
                <p class="mb-6 max-w-sm leading-relaxed">Formaci√≥n profesional dise√±ada para el mercado laboral actual. Sin relleno, solo contenido accionable y mentores expertos.</p>
                <div class="flex gap-4">
                    <a href="#" class="p-2 bg-white/5 rounded-full hover:bg-brand-600 hover:text-white transition"><i data-lucide="instagram" class="w-5 h-5"></i></a>
                    <a href="#" class="p-2 bg-white/5 rounded-full hover:bg-brand-600 hover:text-white transition"><i data-lucide="linkedin" class="w-5 h-5"></i></a>
                    <a href="#" class="p-2 bg-white/5 rounded-full hover:bg-brand-600 hover:text-white transition"><i data-lucide="youtube" class="w-5 h-5"></i></a>
                </div>
            </div>
            <div>
                <h4 class="text-white font-bold mb-6 text-lg">Legal</h4>
                <ul class="space-y-4">
                    <li><a href="#" class="hover:text-brand-500 transition">T√©rminos y Condiciones</a></li>
                    <li><a href="#" class="hover:text-brand-500 transition">Pol√≠tica de Privacidad</a></li>
                    <li><a href="#" onclick="app.router('contact')" class="hover:text-brand-500 transition">Soporte</a></li>
                </ul>
            </div>
            <div>
                <h4 class="text-white font-bold mb-6 text-lg">Explora</h4>
                <ul class="space-y-3">
                    <li><a href="#" onclick="app.router('store')" class="hover:text-brand-500 transition">Cat√°logo de Cursos</a></li>
                    <li><a href="#" onclick="app.router('services')" class="hover:text-brand-500 transition">Servicios Corporativos</a></li>
                    <li><a href="#" onclick="app.router('blog')" class="hover:text-brand-500 transition">Recursos Gratuitos</a></li>
                </ul>
            </div>
            <div>
                <h4 class="text-white font-bold mb-6 text-lg">Mantente Actualizado</h4>
                <p class="text-sm mb-4">Recibe ofertas flash y tutoriales nuevos.</p>
                <form onsubmit="app.handlers.newsletter(event)" class="flex flex-col gap-3">
                    <input type="email" placeholder="tu@email.com" required class="bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-brand-500 transition">
                    <button type="submit" class="bg-brand-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-brand-500 transition">Suscribirme</button>
                </form>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-4 pt-8 border-t border-slate-800 text-center text-sm opacity-60">
            <p>&copy; 2025 eContademy Inc. Todos los derechos reservados.</p>
        </div>
    </footer>

    <div id="cart-sidebar" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity duration-300" onclick="app.toggleCart()"></div>
        <div class="absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-2xl flex flex-col transform transition-transform duration-300 translate-x-full" id="cart-panel">
            <div class="p-6 border-b flex justify-between items-center bg-slate-50">
                <h2 class="text-xl font-bold text-slate-900 flex items-center gap-2"><i data-lucide="shopping-bag"></i> Tu Carrito</h2>
                <button onclick="app.toggleCart()" class="p-2 hover:bg-red-50 text-slate-400 hover:text-red-500 rounded-full transition"><i data-lucide="x"></i></button>
            </div>
            
            <div id="cart-content" class="flex-1 overflow-y-auto p-6 space-y-4"></div>
            
            <div class="p-6 bg-slate-50 border-t shadow-[0_-4px_20px_rgba(0,0,0,0.05)]">
                <div class="space-y-3 mb-6">
                    <div class="flex justify-between text-slate-500"><span>Subtotal</span><span id="cart-subtotal" class="font-medium">$0.00</span></div>
                    <div id="discount-row" class="flex justify-between text-green-600 hidden"><span>Descuento</span><span id="cart-discount" class="font-bold">-$0.00</span></div>
                    <div class="flex justify-between text-2xl font-bold text-slate-900 pt-3 border-t"><span>Total</span><span id="cart-total">$0.00</span></div>
                </div>
                <button onclick="app.openCheckout()" class="w-full bg-slate-900 text-white py-4 rounded-xl font-bold text-lg hover:bg-brand-600 transition shadow-lg hover:shadow-brand-500/25 flex justify-center items-center gap-2 group">
                    Completar Compra <i data-lucide="arrow-right" class="group-hover:translate-x-1 transition"></i>
                </button>
                <div class="flex justify-center gap-4 mt-4 text-slate-300">
                    <i data-lucide="credit-card" class="w-5 h-5"></i>
                    <i data-lucide="lock" class="w-5 h-5"></i>
                </div>
            </div>
        </div>
    </div>

    <div id="checkout-modal" class="fixed inset-0 z-[70] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/90 backdrop-blur-sm" onclick="document.getElementById('checkout-modal').classList.add('hidden')"></div>
        <div class="bg-white rounded-3xl w-full max-w-lg relative z-10 overflow-hidden shadow-2xl animate-slide-up max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-slate-900 to-slate-800 p-8 text-white">
                <h3 class="text-2xl font-bold">Finalizar Pedido</h3>
                <p class="text-slate-400 text-sm mt-1">Acceso inmediato tras confirmar.</p>
            </div>
            <div class="p-8">
                <form onsubmit="app.handlers.submitOrder(event)" class="space-y-5">
                    <div class="grid md:grid-cols-2 gap-5">
                        <div class="col-span-2">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Nombre Completo</label>
                            <input type="text" id="chk-name" required class="w-full bg-slate-50 border border-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-brand-500 outline-none transition">
                        </div>
                        <div class="col-span-2 md:col-span-1">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Email</label>
                            <input type="email" id="chk-email" required placeholder="ejemplo@mail.com" class="w-full bg-slate-50 border border-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-brand-500 outline-none transition">
                        </div>
                        <div class="col-span-2 md:col-span-1">
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Tel√©fono</label>
                            <input type="tel" id="chk-phone" required placeholder="+56 9..." class="w-full bg-slate-50 border border-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-brand-500 outline-none transition">
                        </div>
                    </div>

                    <div class="bg-brand-50/50 p-4 rounded-xl border border-dashed border-brand-200">
                        <label class="block text-xs font-bold text-brand-600 uppercase mb-2"><i data-lucide="ticket" class="w-3 h-3 inline mr-1"></i> Cup√≥n de Descuento</label>
                        <div class="flex gap-2">
                            <input type="text" id="chk-coupon-code" placeholder="EJ: PROMO20" class="flex-1 p-2.5 border border-slate-200 rounded-lg uppercase text-sm focus:outline-none focus:border-brand-500">
                            <button type="button" onclick="app.handlers.checkCoupon()" class="bg-white border border-slate-200 px-4 rounded-lg font-bold text-slate-600 text-xs hover:bg-slate-50 transition shadow-sm">APLICAR</button>
                        </div>
                        <p id="coupon-msg" class="text-xs mt-2 font-bold hidden flex items-center gap-1"></p>
                    </div>

                    <div class="flex items-start gap-3 bg-slate-50 p-3 rounded-lg">
                        <input type="checkbox" id="chk-news" checked class="mt-1 w-4 h-4 text-brand-600 rounded focus:ring-brand-500">
                        <label for="chk-news" class="text-xs text-slate-600 leading-relaxed">
                            Quiero recibir actualizaciones de cursos y descuentos exclusivos en mi correo.
                        </label>
                    </div>

                    <button type="submit" class="w-full bg-brand-600 text-white py-4 rounded-xl font-bold hover:bg-brand-700 transition shadow-lg shadow-brand-500/20 flex justify-center items-center gap-2 text-lg">
                        Confirmar y Pagar
                    </button>
                    <p class="text-[10px] text-center text-slate-400">Al confirmar aceptas nuestros t√©rminos y condiciones.Te enviaremos las credenciales a tu correo.</p>
                </form>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-8 right-8 bg-slate-900 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center gap-4 transform translate-y-24 opacity-0 transition-all duration-500 z-[100] border border-slate-700">
        <div class="bg-green-500 rounded-full p-1 shadow-[0_0_10px_rgba(34,197,94,0.5)]"><i data-lucide="check" class="w-4 h-4 text-white"></i></div>
        <div>
            <h4 class="font-bold text-sm">Sistema</h4>
            <p id="toast-msg" class="text-xs text-slate-400">Notificaci√≥n</p>
        </div>
    </div>

    <script>
        // === CONFIGURACI√ìN CR√çTICA ===
        // PEGA AQU√ç TU NUEVA URL DEL SCRIPT V3
        const API_URL = "https://script.google.com/macros/s/AKfycbyHBD8OfDVfggXuKjnDYTfES5przzsGb8IhfU5VvFAumyL1rdmse8RorJeIrt3rROH6/exec"; 

        const app = {
            data: { productos: [], blog: [], servicios: [] },
            cart: JSON.parse(localStorage.getItem('ec_cart_v3')) || [],
            user: null,
            activeCoupon: null,
            sliderInterval: null,

            // INIT
            init: async () => {
                lucide.createIcons();
                app.updateCartUI();
                await app.fetchData();
                app.router('home');
            },

            // FETCH DATOS CON FALLBACK
            fetchData: async () => {
                try {
                    const res = await fetch(API_URL);
                    const json = await res.json();
                    if(json.status === 'error') throw new Error(json.message);
                    app.data = json;
                } catch(e) {
                    console.error("Modo Offline:", e);
                    app.showToast("Modo demostraci√≥n activado (API Offline)");
                    // Datos de respaldo para que la web se vea bonita
                    app.data.productos = [
                        {id:'1', titulo:'M√°ster en Python', precio:49.99, categoria:'Curso', imagen:'https://images.unsplash.com/photo-1526379095098-d400fd0bf935?w=600', descripcion:'Backend profesional con Django.'},
                        {id:'2', titulo:'Excel para Negocios', precio:29.99, categoria:'Curso', imagen:'https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=600', descripcion:'Tablas din√°micas y Macros.'},
                        {id:'3', titulo:'Marketing Digital', precio:39.99, categoria:'Curso', imagen:'https://images.unsplash.com/photo-1533750349088-cd877a032f33?w=600', descripcion:'Estrategias SEO y SEM.'}
                    ];
                    app.data.blog = [
                        {id:'b1', titulo:'C√≥mo estudiar online', autor:'eContademy', fecha:'2024', imagen:'https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=600', contenido:'Tips...'}
                    ];
                }
            },

            // ROUTER --- NAVEGACI√ìN Y SEO ---
            router: (view) => {
                const main = document.getElementById('main-view');
                window.scrollTo(0,0);
                if(app.sliderInterval) clearInterval(app.sliderInterval);

                // 1. HOME VIEW
                if (view === 'home') {
		    app.updateSEO('Inicio', 'Plataforma l√≠der en cursos online.');
                    main.innerHTML = `
                        <div class="slider-container">
                            <div class="slide active">
                                <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1920" class="absolute inset-0 w-full h-full object-cover">
                                <div class="slide-overlay"></div>
                                <div class="slide-text absolute inset-0 flex flex-col items-center justify-center text-center text-white px-4 animate-slide-up">
                                    <span class="bg-brand-600/20 border border-brand-500/50 px-4 py-1 rounded-full text-sm font-bold mb-6 backdrop-blur-sm text-brand-300">üöÄ Nueva Temporada 2025</span>
                                    <h1 class="text-5xl md:text-7xl font-black mb-6 leading-tight tracking-tight">Domina el Futuro <br> <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-400 to-cyan-300">Digital</span></h1>
                                    <p class="text-lg md:text-xl text-slate-300 mb-10 max-w-2xl">La plataforma educativa que conecta tu talento con las oportunidades reales del mercado.</p>
                                    <div class="flex flex-col md:flex-row gap-4 justify-center">
                                        <button onclick="app.router('store')" class="bg-brand-600 hover:bg-brand-700 text-white px-8 py-4 rounded-full font-bold transition shadow-lg shadow-brand-500/25">Ver Cursos</button>
                                        <button onclick="app.router('contact')" class="bg-white/10 backdrop-blur border border-white/20 text-white px-8 py-4 rounded-full font-bold hover:bg-white hover:text-dark transition">Cont√°ctanos</button>
                                    </div>
                                </div>
                            </div>
                             <div class="slide">
                                <img src="https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?auto=format&fit=crop&w=1920" class="absolute inset-0 w-full h-full object-cover">
                                <div class="slide-overlay"></div>
                                <div class="slide-text absolute inset-0 flex flex-col items-start justify-center text-left text-white px-4 md:px-20 max-w-7xl mx-auto">
                                    <h2 class="text-5xl md:text-7xl font-black mb-6">Aprende<br>Haciendo.</h2>
                                    <p class="text-xl text-slate-300 mb-10 max-w-lg">Sin teor√≠a aburrida. Proyectos 100% pr√°cticos desde el primer d√≠a.</p>
                                    <button onclick="app.router('store')" class="bg-white text-dark px-8 py-4 rounded-full font-bold hover:bg-slate-200 transition">Empezar Ahora</button>
                                </div>
                            </div>
                        </div>

                        <section class="py-20 bg-white relative z-10 -mt-10 rounded-t-3xl mx-2 shadow-2xl border-b border-slate-100">
                            <div class="max-w-7xl mx-auto px-4">
                                <div class="text-center mb-16">
                                    <h2 class="text-3xl font-bold text-slate-900">¬øPor qu√© eContademy?</h2>
                                    <p class="text-slate-500 mt-2">Resultados comprobados por miles de estudiantes.</p>
                                </div>
                                <div class="grid md:grid-cols-3 gap-10">
                                    <div class="p-6 bg-slate-50 rounded-2xl border border-slate-100 hover:shadow-lg transition">
                                        <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-xl flex items-center justify-center mb-4"><i data-lucide="award" class="w-6 h-6"></i></div>
                                        <h3 class="font-bold text-lg mb-2">Certificaci√≥n V√°lida</h3>
                                        <p class="text-slate-500 text-sm">A√±ade valor real a tu CV y LinkedIn con nuestras credenciales verificables.</p>
                                    </div>
                                    <div class="p-6 bg-slate-50 rounded-2xl border border-slate-100 hover:shadow-lg transition">
                                        <div class="w-12 h-12 bg-purple-100 text-purple-600 rounded-xl flex items-center justify-center mb-4"><i data-lucide="video" class="w-6 h-6"></i></div>
                                        <h3 class="font-bold text-lg mb-2">Calidad 4K</h3>
                                        <p class="text-slate-500 text-sm">Contenido audiovisual de primera categor√≠a para una experiencia inmersiva.</p>
                                    </div>
                                    <div class="p-6 bg-slate-50 rounded-2xl border border-slate-100 hover:shadow-lg transition">
                                        <div class="w-12 h-12 bg-green-100 text-green-600 rounded-xl flex items-center justify-center mb-4"><i data-lucide="users" class="w-6 h-6"></i></div>
                                        <h3 class="font-bold text-lg mb-2">Comunidad Activa</h3>
                                        <p class="text-slate-500 text-sm">Resuelve dudas al instante con instructores y compa√±eros de todo el mundo.</p>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section class="py-24 bg-slate-50">
                            <div class="max-w-7xl mx-auto px-4">
                                <div class="flex justify-between items-end mb-12">
                                    <div>
                                        <span class="text-brand-600 font-bold uppercase text-xs tracking-wider">Tendencias</span>
                                        <h2 class="text-3xl font-bold text-slate-900 mt-1">Cursos M√°s Vendidos</h2>
                                    </div>
                                    <button onclick="app.router('store')" class="hidden md:flex text-slate-600 font-bold items-center gap-2 hover:text-brand-600 transition">Ver todo <i data-lucide="arrow-right" class="w-4 h-4"></i></button>
                                </div>
                                <div class="grid md:grid-cols-3 lg:grid-cols-4 gap-8">
                                    ${app.data.productos.slice(0, 4).map(p => app.components.card(p)).join('')}
                                </div>
                                <button onclick="app.router('store')" class="md:hidden w-full mt-8 bg-white border border-slate-200 py-3 rounded-xl font-bold text-slate-600">Ver todo el cat√°logo</button>
                            </div>
                        </section>
                    `;
                    app.initSlider();
                }
                

                // 2. STORE VIEW
                else if (view === 'store') {
                    app.updateSEO('Tienda', 'Cat√°logo completo de cursos.');
                    main.innerHTML = `
                        <div class="bg-slate-900 py-20 text-center text-white">
                            <h1 class="text-4xl font-bold mb-2">Cat√°logo 2025</h1>
                            <p class="text-slate-400">Invierte en herramientas y conocimiento.</p>
                        </div>
                        <div class="max-w-7xl mx-auto px-4 py-16 grid md:grid-cols-3 lg:grid-cols-4 gap-8">
                            ${app.data.productos.map(p => app.components.card(p)).join('')}
                        </div>
                    `;
                }

                // 3. SERVICES VIEW
                else if (view === 'services') {
                    app.updateSEO('Servicios', 'Soluciones corporativas.');
                    main.innerHTML = `
                        <div class="max-w-7xl mx-auto px-4 py-20">
                            <div class="text-center mb-16">
                                <h2 class="text-4xl font-bold text-slate-900">Soluciones Corporativas</h2>
                                <p class="text-xl text-slate-500 mt-4 max-w-2xl mx-auto">Transformaci√≥n digital para tu empresa.</p>
                            </div>
                            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                                ${app.data.servicios ? app.data.servicios.map(s => `
                                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-100 hover:shadow-xl transition group">
                                        <div class="w-14 h-14 bg-brand-50 rounded-xl flex items-center justify-center text-brand-600 mb-6 group-hover:bg-brand-600 group-hover:text-white transition">
                                            <i data-lucide="${s.icono || 'briefcase'}" class="w-7 h-7"></i>
                                        </div>
                                        <h3 class="text-2xl font-bold mb-3">${s.titulo}</h3>
                                        <p class="text-slate-500 mb-6">${s.descripcion}</p>
                                        <div class="mt-auto pt-6 border-t border-slate-100 flex justify-between items-center">
                                            <span class="font-bold text-slate-900">${s.precio}</span>
                                            <button onclick="app.router('contact')" class="text-brand-600 font-bold text-sm">Cotizar ‚Üí</button>
                                        </div>
                                    </div>
                                `).join('') : '<p class="col-span-3 text-center">Cargando servicios...</p>'}
                            </div>
                        </div>
                    `;
                }

                // 4. BLOG VIEW
                else if (view === 'blog') {
                    app.updateSEO('Blog', 'Noticias y tutoriales.');
                    main.innerHTML = `
                        <div class="max-w-5xl mx-auto px-4 py-16">
                            <h2 class="text-4xl font-bold mb-10 border-l-4 border-brand-500 pl-4">Blog & Novedades</h2>
                            <div class="space-y-12">
                                ${app.data.blog.map(post => `
                                    <article class="flex flex-col md:flex-row gap-8 items-start bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                        <img src="${post.imagen}" class="w-full md:w-64 h-48 object-cover rounded-xl shadow-md">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-4 text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">
                                                <span>${post.fecha}</span> ‚Ä¢ <span>${post.autor}</span>
                                            </div>
                                            <h3 class="text-2xl font-bold mb-3 text-slate-900">${post.titulo}</h3>
                                            <p class="text-slate-600 leading-relaxed mb-4 line-clamp-3">${post.contenido}</p>
                                            <button class="text-brand-600 font-bold text-sm">Leer Art√≠culo Completo</button>
                                        </div>
                                    </article>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }

                // 5. CONTACT VIEW
                else if (view === 'contact') {
                    app.updateSEO('Contacto', 'Estamos para ayudarte.');
                    main.innerHTML = `
                        <div class="max-w-7xl mx-auto px-4 py-20">
                            <div class="grid md:grid-cols-2 gap-16 bg-white rounded-3xl shadow-2xl overflow-hidden">
                                <div class="bg-slate-900 p-12 text-white flex flex-col justify-between relative overflow-hidden">
                                    <div class="relative z-10">
                                        <h2 class="text-3xl font-bold mb-6">Hablemos</h2>
                                        <p class="text-slate-400 mb-8">Estamos listos para responder tus dudas.</p>
                                        <div class="space-y-6">
                                            <div class="flex items-center gap-4"><i data-lucide="map-pin" class="text-brand-500"></i><p>Av. Innovaci√≥n 123</p></div>
                                            <div class="flex items-center gap-4"><i data-lucide="mail" class="text-brand-500"></i><p>hola@eContademy.com</p></div>
                                            <div class="flex items-center gap-4"><i data-lucide="phone" class="text-brand-500"></i><p>+1 234 567 890</p></div>
                                        </div>
                                    </div>
                                    <i data-lucide="globe" class="absolute -bottom-10 -right-10 w-64 h-64 text-slate-800 opacity-50"></i>
                                </div>
                                <div class="p-12">
                                    <form onsubmit="app.handlers.submitContact(event)" class="space-y-6">
                                        <div class="grid md:grid-cols-2 gap-6">
                                            <div><label class="block font-bold text-sm mb-2">Nombre</label><input type="text" id="c-name" class="w-full bg-slate-50 border p-3 rounded-lg outline-none focus:border-brand-500"></div>
                                            <div><label class="block font-bold text-sm mb-2">Email</label><input type="email" id="c-email" class="w-full bg-slate-50 border p-3 rounded-lg outline-none focus:border-brand-500"></div>
                                        </div>
                                        <div><label class="block font-bold text-sm mb-2">Asunto</label><input type="text" id="c-subject" class="w-full bg-slate-50 border p-3 rounded-lg outline-none focus:border-brand-500"></div>
                                        <div><label class="block font-bold text-sm mb-2">Mensaje</label><textarea id="c-msg" rows="4" class="w-full bg-slate-50 border p-3 rounded-lg outline-none focus:border-brand-500"></textarea></div>
                                        <button type="submit" class="w-full bg-brand-600 text-white py-4 rounded-xl font-bold shadow-lg hover:bg-brand-700 transition">Enviar Mensaje</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    `;
                }

                // 6. LMS VIEW
                else if (view === 'lms') {
                    app.updateSEO('Aula Virtual', 'Acceso estudiantes.');
                    if (!app.user) {
                        main.innerHTML = `
                            <div class="min-h-[70vh] flex items-center justify-center px-4 bg-slate-50">
                                <div class="bg-white p-10 rounded-3xl shadow-xl w-full max-w-md border border-slate-100 text-center">
                                    <div class="w-16 h-16 bg-brand-100 text-brand-600 rounded-2xl flex items-center justify-center mx-auto mb-6"><i data-lucide="lock" class="w-8 h-8"></i></div>
                                    <h2 class="text-2xl font-bold text-slate-900 mb-2">Acceso Estudiantes</h2>
                                    <p class="text-slate-500 text-sm mb-8">Usa el ID de Pedido que recibiste por correo.</p>
                                    <form onsubmit="app.handlers.login(event)" class="space-y-4 text-left">
                                        <div><label class="text-xs font-bold text-slate-500 uppercase">Email</label><input type="email" id="lms-email" class="w-full p-3 border border-slate-200 rounded-lg mt-1 outline-none focus:border-brand-500"></div>
                                        <div><label class="text-xs font-bold text-slate-500 uppercase">Contrase√±a (ID Pedido)</label><input type="password" id="lms-pass" class="w-full p-3 border border-slate-200 rounded-lg mt-1 outline-none focus:border-brand-500"></div>
                                        <button type="submit" class="w-full bg-brand-600 text-white py-3 rounded-lg font-bold hover:bg-brand-700 transition">Entrar al Aula</button>
                                    </form>
                                </div>
                            </div>
                        `;
                    } else {
                        main.innerHTML = `
                            <div class="bg-slate-900 text-white py-6 px-4 sticky top-20 z-40 shadow-lg"><div class="max-w-7xl mx-auto flex justify-between items-center"><div><h2 class="text-xl font-bold">Hola, ${app.user.nombre}</h2><p class="text-slate-400 text-xs">Estudiante Activo</p></div><button onclick="app.logout()" class="text-red-400 text-sm font-bold hover:text-red-300">Cerrar Sesi√≥n</button></div></div>
                            <div class="max-w-7xl mx-auto px-4 py-12 space-y-10">
                                ${app.user.cursos.length ? app.user.cursos.map(c => `
                                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-slate-100">
                                        <div class="p-4 bg-slate-50 border-b font-bold text-lg flex items-center gap-2"><i data-lucide="play-circle" class="text-brand-600"></i> ${c.titulo}</div>
                                        <div class="grid lg:grid-cols-3">
                                            <div class="lg:col-span-2 bg-black aspect-video relative">
                                                ${c.videoUrl ? `<iframe src="${c.videoUrl}" class="absolute inset-0 w-full h-full" frameborder="0" allowfullscreen></iframe>` : '<div class="flex h-full items-center justify-center text-white">Video no disponible</div>'}
                                            </div>
                                            <div class="p-8">
                                                <h4 class="font-bold mb-4 text-slate-900">Material de Clase</h4>
                                                <a href="${c.materialUrl}" target="_blank" class="flex items-center gap-3 p-4 border border-slate-200 rounded-xl hover:border-brand-500 hover:bg-brand-50 transition group">
                                                    <div class="bg-slate-100 p-2 rounded-lg group-hover:bg-white"><i data-lucide="file-text" class="text-slate-600 group-hover:text-brand-600"></i></div>
                                                    <div><p class="font-bold text-sm text-slate-900">Descargar Archivos</p><p class="text-xs text-slate-500">PDFs, C√≥digo fuente</p></div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                `).join('') : '<p class="text-center py-20 text-slate-400">No se encontraron cursos. Contacta soporte.</p>'}
                            </div>
                        `;
                    }
                }
                lucide.createIcons();
            },

            // UTILS--- COMPONENTES VISUALES ---
            components: {
                card: (p) => `
                    <div class="bg-white rounded-2xl border border-slate-100 overflow-hidden group hover:shadow-xl hover:-translate-y-1 transition duration-300 flex flex-col h-full">
                        <div class="relative h-52 overflow-hidden">
                            <img src="${p.imagen}" class="w-full h-full object-cover group-hover:scale-110 transition duration-700">
                            <div class="absolute top-3 left-3 flex gap-2">
                                <span class="bg-white/90 backdrop-blur px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide shadow-sm text-slate-700">${p.categoria}</span>
                            </div>
                        </div>
                        <div class="p-5 flex-1 flex flex-col">
                            <h3 class="font-bold text-lg text-slate-900 mb-2 leading-tight">${p.titulo}</h3>
                            <p class="text-slate-500 text-sm mb-4 line-clamp-2 flex-1">${p.descripcion}</p>
                            <div class="mt-auto flex justify-between items-center pt-4 border-t border-slate-50">
                                <span class="text-xl font-black text-slate-900">$${p.precio}</span>
                                <button onclick="app.addToCart('${p.id}')" class="bg-slate-900 text-white w-9 h-9 rounded-full flex items-center justify-center hover:bg-brand-600 transition shadow-lg">
                                    <i data-lucide="plus" class="w-5 h-5"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `
            },

            // LOGICA CARRITO MEJORADA
            addToCart: (id) => {
                const prod = app.data.productos.find(p => p.id === id);
                const exist = app.cart.find(i => i.id === id);
                exist ? exist.qty++ : app.cart.push({...prod, qty:1});
                app.saveCart();
                app.showToast("Producto agregado al carrito");
            },
            removeFromCart: (id) => {
                app.cart = app.cart.filter(i => i.id !== id);
                app.saveCart();
            },
            saveCart: () => {
                localStorage.setItem('ec_cart_v3', JSON.stringify(app.cart));
                app.updateCartUI();
            },
            updateCartUI: () => {
                const badge = document.getElementById('cart-badge');
                const qty = app.cart.reduce((a,b)=>a+b.qty,0);
                badge.innerText = qty;
                badge.classList.toggle('scale-0', qty === 0);

                const container = document.getElementById('cart-content');
                if(!container) return;

                if(app.cart.length === 0) {
                    container.innerHTML = '<div class="flex flex-col items-center justify-center h-full text-slate-400 opacity-50"><i data-lucide="shopping-bag" class="w-16 h-16 mb-4"></i><p>Tu carrito est√° vac√≠o</p></div>';
                    document.getElementById('cart-total').innerText = "$0.00";
                    document.getElementById('discount-row').classList.add('hidden');
                } else {
                    container.innerHTML = app.cart.map(i => `
                        <div class="flex gap-4 bg-white p-3 rounded-xl border border-slate-100 shadow-sm mb-3">
                            <img src="${i.imagen}" class="w-16 h-16 rounded-lg object-cover">
                            <div class="flex-1">
                                <h4 class="font-bold text-sm text-slate-900 line-clamp-1">${i.titulo}</h4>
                                <div class="flex justify-between items-center mt-2">
                                    <span class="text-xs text-slate-500 font-medium">$${i.precio} x ${i.qty}</span>
                                    <button onclick="app.removeFromCart('${i.id}')" class="text-red-400 hover:bg-red-50 p-1 rounded transition"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                </div>
                            </div>
                        </div>
                    `).join('');

                    let subtotal = app.cart.reduce((a,b)=>a+(b.precio*b.qty), 0);
                    let total = subtotal;

                    const discountRow = document.getElementById('discount-row');
                    const discountEl = document.getElementById('cart-discount');

                    if(app.activeCoupon) {
                        discountRow.classList.remove('hidden');
                        let discountVal = app.activeCoupon.type === 'percent' 
                            ? subtotal * (app.activeCoupon.value / 100)
                            : app.activeCoupon.value;
                        discountEl.innerText = `-$${discountVal.toFixed(2)}`;
                        total = subtotal - discountVal;
                    } else {
                        discountRow.classList.add('hidden');
                    }

                    document.getElementById('cart-subtotal').innerText = `$${subtotal.toFixed(2)}`;
                    document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
                }
                lucide.createIcons();
            },

            // HANDLERS DE EVENTOS
            handlers: {
                submitOrder: async (e) => {
                    e.preventDefault();
                    if(app.cart.length === 0) return alert("Carrito vac√≠o");

                    const btn = e.target.querySelector('button[type="submit"]');
                    const originalText = btn.innerHTML;
		    btn.innerHTML = `<div class="loader mr-2"></div> Procesando...`; btn.disabled = true;

                    const totalCalculado = document.getElementById('cart-total').innerText;
                    
                    const payload = {
                        action: 'checkout',
                        nombre: document.getElementById('chk-name').value,
                        email: document.getElementById('chk-email').value,
                        telefono: document.getElementById('chk-phone').value,
                        newsletter: document.getElementById('chk-news').checked,
                        cuponCodigo: app.activeCoupon ? app.activeCoupon.codigo : null, // ENVIAMOS SOLO CODIGO PARA QUE BACKEND VALIDE
                        carrito: app.cart,
                        total: totalCalculado
                    };

                    try {
                        const res = await fetch(API_URL, {method: 'POST', body: JSON.stringify(payload)});
                        const json = await res.json();

                        if(json.status === 'success') {
                            // EFECTO DE CELEBRACI√ìN
                            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                            e.target.reset(); // LIMPIEZA FORMULARIO
                            app.cart = []; app.activeCoupon = null; app.saveCart();
                            document.getElementById('checkout-modal').classList.add('hidden');
                            alert(`¬°PEDIDO CONFIRMADO!\n\nID: ${json.idPedido}\n\nRevisa tu correo (${payload.email}) para acceder.`);
                        } else {
                            throw new Error(json.message || "Error en servidor");
                        }
                    } catch(err) {
                        alert("Error procesando el pedido: " + err.message);
                    } finally {
                        btn.innerHTML = originalText; btn.disabled = false;
                    }
                },

                checkCoupon: async () => {
                    const code = document.getElementById('chk-coupon-code').value;
                    const msg = document.getElementById('coupon-msg');
                    if(!code) return;

                    msg.innerHTML = '<div class="spinner w-3 h-3 border-slate-500"></div> Validando...';
                    msg.classList.remove('hidden', 'text-red-500', 'text-green-600');

                    try {
                        const res = await fetch(API_URL, {method:'POST', body: JSON.stringify({action:'check_coupon', codigo: code})});
                        const json = await res.json();

                        if(json.status === 'success') {
                            app.activeCoupon = json.cupon; // Guardamos objeto cup√≥n completo
                            msg.innerHTML = `<i data-lucide="check-circle" class="w-3 h-3"></i> Descuento aplicado: ${json.cupon.valor}${json.cupon.tipo==='percent'?'%':'$'}`;
                            msg.classList.add('text-green-600');
                            app.updateCartUI();
                        } else {
                            app.activeCoupon = null;
                            msg.innerHTML = `<i data-lucide="x-circle" class="w-3 h-3"></i> Cup√≥n inv√°lido`;
                            msg.classList.add('text-red-500');
                            app.updateCartUI();
                        }
                    } catch(e) { console.error(e); }
                    lucide.createIcons();
                },

                login: async (e) => {
                    e.preventDefault();
                    const btn = e.target.querySelector('button');
                    const originalText = btn.innerText;
                    btn.innerHTML = "Verificando..."; btn.disabled = true;

                    try {
                        const payload = {
                            action: 'login',
                            email: document.getElementById('lms-email').value,
                            password: document.getElementById('lms-pass').value
                        };
                        const res = await fetch(API_URL, {method:'POST', body:JSON.stringify(payload)});
                        const json = await res.json();
                        
                        if(json.status === 'success') {
                            app.user = json;
                            app.router('lms');
                        } else {
                            alert("Datos incorrectos. Revisa tu correo.");
                        }
                    } catch(e) { alert("Error de conexi√≥n"); }
                    finally { btn.innerText = originalText; btn.disabled = false; }
                },

                newsletter: async (e) => {
                    e.preventDefault();
                    const email = e.target.querySelector('input').value;
                    await fetch(API_URL, {method:'POST', body:JSON.stringify({action:'newsletter', email: email})});
                    app.showToast("Suscripci√≥n exitosa");
                    e.target.reset();
                }
            },

            // UTILS
            toggleCart: () => {
                const sidebar = document.getElementById('cart-sidebar');
                const panel = document.getElementById('cart-panel');
                if(sidebar.classList.contains('hidden')) {
                    sidebar.classList.remove('hidden');
                    setTimeout(()=>panel.classList.remove('translate-x-full'), 10);
                } else {
                    panel.classList.add('translate-x-full');
                    setTimeout(()=>sidebar.classList.add('hidden'), 300);
                }
            },
            openCheckout: () => { app.toggleCart(); document.getElementById('checkout-modal').classList.remove('hidden'); },
            showToast: (text) => {
                const t = document.getElementById('toast');
                document.getElementById('toast-msg').innerText = text;
                t.classList.remove('translate-y-24', 'opacity-0');
                setTimeout(()=>t.classList.add('translate-y-24', 'opacity-0'), 3000);
            },
            updateSEO: (title, desc) => {
                document.title = `${title} | eContademy`;
                document.querySelector('meta[name="description"]').setAttribute("content", desc);
            },
            logout: () => { app.user = null; app.router('lms'); },
            initSlider: () => {
                let idx = 0;
                const slides = document.querySelectorAll('.slide');
                if(!slides.length) return;
                app.sliderInterval = setInterval(() => {
                    slides.forEach(s => s.classList.remove('active'));
                    idx = (idx + 1) % slides.length;
                    slides[idx].classList.add('active');
                }, 5000);
            }
        };
        // INICIAR APP
        document.addEventListener('DOMContentLoaded', app.init);
        function toggleMobile() { document.getElementById('mobile-menu').classList.toggle('hidden'); }
    </script>
</body>
</html>